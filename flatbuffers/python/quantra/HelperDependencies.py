# automatically generated by the FlatBuffers compiler, do not modify

# namespace: quantra

import flatbuffers
from flatbuffers.compat import import_numpy
np = import_numpy()

class HelperDependencies(object):
    __slots__ = ['_tab']

    @classmethod
    def GetRootAs(cls, buf, offset=0):
        n = flatbuffers.encode.Get(flatbuffers.packer.uoffset, buf, offset)
        x = HelperDependencies()
        x.Init(buf, n + offset)
        return x

    @classmethod
    def GetRootAsHelperDependencies(cls, buf, offset=0):
        """This method is deprecated. Please switch to GetRootAs."""
        return cls.GetRootAs(buf, offset)
    # HelperDependencies
    def Init(self, buf, pos):
        self._tab = flatbuffers.table.Table(buf, pos)

    # Exogenous discount curve for dual-curve bootstrapping.
    # Supported by: SwapHelper, OISHelper, DatedOISHelper,
    # TenorBasisSwapHelper, FxSwapHelper, CrossCcyBasisHelper.
    # HelperDependencies
    def DiscountCurve(self):
        o = flatbuffers.number_types.UOffsetTFlags.py_type(self._tab.Offset(4))
        if o != 0:
            x = self._tab.Indirect(o + self._tab.Pos)
            from quantra.CurveRef import CurveRef
            obj = CurveRef()
            obj.Init(self._tab.Bytes, x)
            return obj
        return None

    # Exogenous projection/forwarding curve.
    #
    # ⚠️  NOT SUPPORTED for SwapHelper, OISHelper, DatedOISHelper.
    # QuantLib's SwapRateHelper/OISRateHelper override the index forwarding
    # handle via index->clone(termStructureHandle_) during bootstrapping.
    # The projection curve is ALWAYS the curve being bootstrapped for these
    # helpers. Setting this field on Swap/OIS helpers will produce a hard
    # error at parse time.
    #
    # Supported by: TenorBasisSwapHelper, FxSwapHelper, CrossCcyBasisHelper
    # (and future custom helpers that genuinely encode projection relationships).
    # HelperDependencies
    def ProjectionCurve(self):
        o = flatbuffers.number_types.UOffsetTFlags.py_type(self._tab.Offset(6))
        if o != 0:
            x = self._tab.Indirect(o + self._tab.Pos)
            obj = CurveRef()
            obj.Init(self._tab.Bytes, x)
            return obj
        return None

    # Second projection curve for basis/XCCY helpers (e.g. the "other leg").
    # Same restrictions as projection_curve above.
    # HelperDependencies
    def ProjectionCurve2(self):
        o = flatbuffers.number_types.UOffsetTFlags.py_type(self._tab.Offset(8))
        if o != 0:
            x = self._tab.Indirect(o + self._tab.Pos)
            obj = CurveRef()
            obj.Init(self._tab.Bytes, x)
            return obj
        return None

    # FX spot quote reference for FX-implied curve helpers.
    # HelperDependencies
    def FxSpotQuoteId(self):
        o = flatbuffers.number_types.UOffsetTFlags.py_type(self._tab.Offset(10))
        if o != 0:
            return self._tab.String(o + self._tab.Pos)
        return None

def HelperDependenciesStart(builder):
    builder.StartObject(4)

def Start(builder):
    HelperDependenciesStart(builder)

def HelperDependenciesAddDiscountCurve(builder, discountCurve):
    builder.PrependUOffsetTRelativeSlot(0, flatbuffers.number_types.UOffsetTFlags.py_type(discountCurve), 0)

def AddDiscountCurve(builder, discountCurve):
    HelperDependenciesAddDiscountCurve(builder, discountCurve)

def HelperDependenciesAddProjectionCurve(builder, projectionCurve):
    builder.PrependUOffsetTRelativeSlot(1, flatbuffers.number_types.UOffsetTFlags.py_type(projectionCurve), 0)

def AddProjectionCurve(builder, projectionCurve):
    HelperDependenciesAddProjectionCurve(builder, projectionCurve)

def HelperDependenciesAddProjectionCurve2(builder, projectionCurve2):
    builder.PrependUOffsetTRelativeSlot(2, flatbuffers.number_types.UOffsetTFlags.py_type(projectionCurve2), 0)

def AddProjectionCurve2(builder, projectionCurve2):
    HelperDependenciesAddProjectionCurve2(builder, projectionCurve2)

def HelperDependenciesAddFxSpotQuoteId(builder, fxSpotQuoteId):
    builder.PrependUOffsetTRelativeSlot(3, flatbuffers.number_types.UOffsetTFlags.py_type(fxSpotQuoteId), 0)

def AddFxSpotQuoteId(builder, fxSpotQuoteId):
    HelperDependenciesAddFxSpotQuoteId(builder, fxSpotQuoteId)

def HelperDependenciesEnd(builder):
    return builder.EndObject()

def End(builder):
    return HelperDependenciesEnd(builder)

try:
    from typing import Optional
except:
    pass

class HelperDependenciesT(object):

    # HelperDependenciesT
    def __init__(self):
        self.discountCurve = None  # type: Optional[CurveRefT]
        self.projectionCurve = None  # type: Optional[CurveRefT]
        self.projectionCurve2 = None  # type: Optional[CurveRefT]
        self.fxSpotQuoteId = None  # type: str

    @classmethod
    def InitFromBuf(cls, buf, pos):
        helperDependencies = HelperDependencies()
        helperDependencies.Init(buf, pos)
        return cls.InitFromObj(helperDependencies)

    @classmethod
    def InitFromPackedBuf(cls, buf, pos=0):
        n = flatbuffers.encode.Get(flatbuffers.packer.uoffset, buf, pos)
        return cls.InitFromBuf(buf, pos+n)

    @classmethod
    def InitFromObj(cls, helperDependencies):
        x = HelperDependenciesT()
        x._UnPack(helperDependencies)
        return x

    # HelperDependenciesT
    def _UnPack(self, helperDependencies):
        if helperDependencies is None:
            return
        if helperDependencies.DiscountCurve() is not None:
            self.discountCurve = CurveRefT.InitFromObj(helperDependencies.DiscountCurve())
        if helperDependencies.ProjectionCurve() is not None:
            self.projectionCurve = CurveRefT.InitFromObj(helperDependencies.ProjectionCurve())
        if helperDependencies.ProjectionCurve2() is not None:
            self.projectionCurve2 = CurveRefT.InitFromObj(helperDependencies.ProjectionCurve2())
        self.fxSpotQuoteId = helperDependencies.FxSpotQuoteId()

    # HelperDependenciesT
    def Pack(self, builder):
        if self.discountCurve is not None:
            discountCurve = self.discountCurve.Pack(builder)
        if self.projectionCurve is not None:
            projectionCurve = self.projectionCurve.Pack(builder)
        if self.projectionCurve2 is not None:
            projectionCurve2 = self.projectionCurve2.Pack(builder)
        if self.fxSpotQuoteId is not None:
            fxSpotQuoteId = builder.CreateString(self.fxSpotQuoteId)
        HelperDependenciesStart(builder)
        if self.discountCurve is not None:
            HelperDependenciesAddDiscountCurve(builder, discountCurve)
        if self.projectionCurve is not None:
            HelperDependenciesAddProjectionCurve(builder, projectionCurve)
        if self.projectionCurve2 is not None:
            HelperDependenciesAddProjectionCurve2(builder, projectionCurve2)
        if self.fxSpotQuoteId is not None:
            HelperDependenciesAddFxSpotQuoteId(builder, fxSpotQuoteId)
        helperDependencies = HelperDependenciesEnd(builder)
        return helperDependencies
